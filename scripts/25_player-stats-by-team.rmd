---
output:
  html_document:
    toc: yes
    keep_md: TRUE
---

<a href="index.html">Back to index</a>

```{r include = FALSE, message = FALSE}
library(plyr)
library(knitr)
library(ggplot2)

knitr::opts_chunk$set(error = TRUE)

pl_stats <- readRDS(file.path("..", "games",
                              "2014_all-games", "2014_player-game-stats.rds"))
str(pl_stats) # 1400 obs. of  14 variables:

pl_stats_agg <-
  readRDS(file.path("..", "games",
                    "2014_all-games", "2014_player-stats-aggregated.rds"))
str(pl_stats_agg) # 244 obs. of  13 variables:

# when compiled via the control script, team will have been
# read from command line and pre-stored in the environment
# for interactive use and development, set the team here
if(!exists("team")) {
  #team <- "wdcCT"
  team <- "vanNH"
  }

message(team, " > 25_player-stats.rmd:")

pl_stats <- pl_stats[pl_stats$team == team, ]
message("  ", nrow(pl_stats), " rows of player * game stats found")
#str(pl_stats, max.level = 1)

pl_stats_agg <- pl_stats_agg[pl_stats_agg$team == team, ]
message("  ", nrow(pl_stats_agg), " rows of game-aggregated player stats found")
str(pl_stats_agg) # 30 obs. of  13 variables
```

# Player statistics for `r team`

## Data

Tables and figures below based on data from `r length(unique(pl_stats$game))` games. The dataset covers `r length(unique(pl_stats$player))` unique players. There are `r nrow(pl_stats)` rows of player-level statistics, each being a unique combination of a game and a player. 

## Player stat table<a id="player_stat_table"></a>:
```{r echo = FALSE, results = 'asis'}
vars_to_show <- c('last', 'player', 'games', 'points', 'goals', 'assists',
                  'throws', 'completions', 'comp_pct',
                  'def', 'catches', 'drop')
kable(pl_stats_agg[vars_to_show], row.names = FALSE)
```

## Scatterplot: completion percentage vs number of throws
```{r comp_pct_vs_throws, echo = FALSE, warning = FALSE}
p <- ggplot(pl_stats_agg, aes(x = throws, y = comp_pct))
#p + geom_point()
p + geom_text(aes(label = last), size = 4)
```

## Scatterplot: completion percentage vs throws per game
```{r comp_pct_vs_throws_per_game, echo = FALSE, warning = FALSE}
p <- ggplot(pl_stats_agg, aes(x = throws/games, y = comp_pct))
#p + geom_point()
p + geom_text(aes(label = last), size = 4)
```